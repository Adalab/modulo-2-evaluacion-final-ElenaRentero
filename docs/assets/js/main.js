"use strict";const charactersList=document.querySelector(".js-characters-list"),searchBtn=document.querySelector(".js-search-btn"),input=document.querySelector(".js-input"),sectionFavourites=document.querySelector(".js-section-favourites"),favouritesList=document.querySelector(".js-favourites-list"),deleteBtn=document.querySelector(".js-delete-btn"),charactersFavErase=document.querySelectorAll(".js-characters-erase");let allCharacters=[],favouriteCharacters=[];function renderOneCharacter(e){let t="";t=-1===favouriteCharacters.findIndex(t=>t.char_id===e.char_id)?"":"selected";const a=document.createElement("li");a.setAttribute("class",""+t),a.classList.add("characters"),a.classList.add("js-characters-card"),a.setAttribute("id",""+e.char_id);const r=document.createElement("article");r.classList.add("characters__card");const s=document.createElement("img");s.classList.add("characters__card--img"),s.setAttribute("src",""+e.img),s.setAttribute("alt",""+e.name);const c=document.createElement("h2");c.classList.add("characters__card--name");const n=document.createTextNode(""+e.name);c.appendChild(n);const d=document.createElement("p");d.classList.add("characters__card--text");const i=document.createTextNode(""+e.status);return d.appendChild(i),a.appendChild(r),r.appendChild(s),r.appendChild(c),r.appendChild(d),a}function renderAllCharacters(){charactersList.innerHTML="";for(let e=0;e<allCharacters.length;e++)charactersList.appendChild(renderOneCharacter(allCharacters[e]));addListenersCharacters()}function filterCharacters(e){return allCharacters.filter(t=>t.name.toLowerCase().includes(e))}function renderFilterCharacters(e){charactersList.innerHTML="";for(let t=0;t<e.length;t++)charactersList.appendChild(renderOneCharacter(e[t]))}function handleClickSearch(e){e.preventDefault();renderFilterCharacters(filterCharacters(input.value.toLowerCase()))}function addListenersCharacters(){const e=document.querySelectorAll(".js-characters-card");for(const t of e)t.addEventListener("click",handleClickCard)}function renderOneFavourite(e){sectionFavourites.style="display: none; display: block;",deleteBtn.style="display: none; display: block;";let t="";t=-1===favouriteCharacters.findIndex(t=>t.char_id===e.char_id)?"":"selected";const a=document.createElement("li");a.setAttribute("class",""+t),a.classList.add("favourites"),a.classList.add("js-favourites-card"),a.setAttribute("id",""+e.char_id);const r=document.createElement("div");r.classList.add("favourites__erase"),r.classList.add("js-favourites-erase");const s=document.createTextNode("x");r.appendChild(s);const c=document.createElement("article");c.classList.add("favourites__card");const n=document.createElement("img");n.classList.add("favourites__card--img"),n.setAttribute("src",""+e.img),n.setAttribute("alt",""+e.name);const d=document.createElement("h2");d.classList.add("favourites__card--name");const i=document.createTextNode(""+e.name);d.appendChild(i);const l=document.createElement("p");l.classList.add("favourites__card--text");const o=document.createTextNode(""+e.status);return l.appendChild(o),a.appendChild(r),a.appendChild(c),c.appendChild(n),c.appendChild(d),c.appendChild(l),a}function renderAllFavourites(){if(favouritesList.innerHTML="",0===favouriteCharacters.length)sectionFavourites.style="display: block; display: none;";else for(let e=0;e<favouriteCharacters.length;e++)favouritesList.appendChild(renderOneFavourite(favouriteCharacters[e]))}function handleClickCard(e){e.currentTarget.classList.toggle("selected");const t=allCharacters.find(t=>t.char_id===parseInt(e.currentTarget.id)),a=favouriteCharacters.findIndex(t=>t.char_id===parseInt(e.currentTarget.id));-1===a?favouriteCharacters.push(t):favouriteCharacters.splice(a,1),localStorage.setItem("favourites",JSON.stringify(favouriteCharacters)),renderAllFavourites()}const savedFavourites=JSON.parse(localStorage.getItem("favourites"));function handleClickErase(){favouriteCharacters=[],sectionFavourites.style="display: block; display: none;",localStorage.removeItem("favourites");const e=document.querySelectorAll(".js-characters-card");for(let t of e)t.classList.contains("selected")&&t.classList.remove("selected")}null!==savedFavourites&&(favouriteCharacters=savedFavourites,renderAllFavourites(),deleteBtn.style="display: none; display: block;"),searchBtn.addEventListener("click",handleClickSearch),deleteBtn.addEventListener("click",handleClickErase);const serverUrl="https://www.breakingbadapi.com/api/characters";fetch(serverUrl,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{allCharacters=e,renderAllCharacters()});